<header ng-controller="navigationController" class="hWrapper actions-menu unselectable">

  <div class="rWrapper titleLevel">
    <div custom-dropdown dropdown-toggle class="f0 has-dropdown medFontSize" dropdown-menu="dropdown-projects-menu">

      <a class="menu-trigger action hTitle dropdown-field">
        <span class="current-project dropdown-value" ng-bind="project.name"></span>
        <span class="arrow-down"></span>
      </a>

      <div class="listWrapper listWrapperSkin custom-dropdown-menu" id="dropdown-projects-menu">
        <a class="menuitem" href="#/issues">
          <span class="menuitem-content">
            <span>Tous les projets</span>
          </span>
        </a>
        <div class="submenu-link" ng-class="{'separator-horizontal': frequent_projects.length > 0}"></div>
        <a ng-repeat="project in frequent_projects" class="menuitem" href=""><span class="menuitem-content"><span>{{ project.name }}</span></span></a>
        <div class="submenu-link separator-horizontal"></div>
        <div class="action-item keep-open">

          <span>
            <input ng-model="search.name" type="text" class="invisible-input" placeholder="Filtrer" id="filter-projects" autocomplete="off"/>
          </span>

          <span ng-show="search.name">
            <a ng-href="#/issues/filters?project_name={{ search.name }}&assigned_to_id={{ current.filters['assigned_to_id'] }}" class="search_filter btn btn-default">
              <img src="/plugin_assets/redmine_angular_ui/images/filter_list.svg" width="24" height="24" style="fill:#555555;color:#555555;">
            </a>
          </span>

        </div>
        <div class="submenu-link separator-horizontal"></div>
        <div class="vFader">
          <div class="vSlider" id="projects-list">
            <a class="menuitem disable" ng-hide="app.projects" href="#"><span class="menuitem-content"><span>Projets en cours de chargement</span></span></a>
            <a class="menuitem" ng-class="{'is-hover': $first, disable: project.allowed_to_view_issues === 0}" ng-repeat="project in app.projects | filter:{name: search.name}" ng-href="{{ project.allowed_to_view_issues === 1 ? ('#/issues/filters?project_id=' + project.id + '&assigned_to_id=' + current.filters['assigned_to_id']) : '#/issues' }}">
              <span class="menuitem-content">
                <span>{{ project.name }}</span>
              </span>
            </a>
          </div>
        </div>
      </div>
    </div>

    <!--
    <div custom-dropdown dropdown-toggle class="f0 has-dropdown medFontSize" dropdown-menu="dropdown-stages-menu">
      <a class="menu-trigger action  dropdown-field">
        <span class="current-stage dropdown-value">Demandes</span>
        <span class="arrow-down"></span>
      </a>
      <div class="listWrapper listWrapperSkin custom-dropdown-menu has-selectable-items" id="dropdown-stages-menu">
        <div ng-repeat="stage in stages" ng-class="{'selected-item': stage == current.stage}" class="menuitem"><div class="menuitem-content"><span>{{ stage }}</span></div></div>
        <div class="submenu-link separator-horizontal"></div>
        <div class="menuitem"><div class="menuitem-content"><span>Administration</span></div></div>
      </div>
    </div>
    -->

    <div class="f2 search-wrapper medFontSize">
      <form>
        <switch name="issues_filter" ng-model="current.permanent_mode"></switch>
      </form>
    </div>

  </div>

</header>
